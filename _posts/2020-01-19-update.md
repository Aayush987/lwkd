---
layout: post
title: Week Ending January 19, 2020
date: 2020-01-21 22:00:00 -0000
slug: 2020-01-19-update
---

## Developer News

Kubernetes new [Data Protection WG](https://github.com/kubernetes/community/tree/master/wg-data-protection) has been approved, and has started work.  Join [their list](https://groups.google.com/forum/#!forum/kubernetes-data-protection).

As part of migrating to a community-controlled, all-open source testing platform, and let the GCE staff get on with their lives, the testgrid summaries [are being generated by new code](https://groups.google.com/forum/?utm_medium=email&utm_source=footer#!topic/kubernetes-dev/DbV4MpQ3TZg).  If the summaries look wonky, try the old ones by appending `?summary=old` to your testgrid URLs, and report and difference to SIG-Testing.

The [testing_frameworks](https://github.com/kubernetes-retired/testing_frameworks) repo [has been retired](https://github.com/kubernetes/org/issues/1519).

## Meeting Summary

Kubernetes had the first [Community Meeting](https://www.youtube.com/watch?v=Wp7DPvmosu0&feature=youtu.be) in the new Monthly format last Thursday. This included updates from [SIG-Scheduling](https://docs.google.com/presentation/d/1H27SDMqkzq8zCRveWWtK5g9hCAomKbrzTTVZ5r4h6Xo/edit#slide=id.g401c104a3c_0_0), [SIG-Cloud Provider](https://docs.google.com/presentation/d/1NX2TnKcqGm_Pg54n690gmd-HCYxsk6agnQsBIrDBNiU/edit#slide=id.g401c104a3c_0_0), SIG-Autoscaling, and [SIG-Scalability](https://docs.google.com/presentation/d/1T_et57l52gueQSWEKBamy9jDcXVx0Vle6dbt4jIX2SU/edit?usp=sharing).  If you missed it, watch the [video](https://www.youtube.com/watch?v=Wp7DPvmosu0&feature=youtu.be) or read the [notes](https://docs.google.com/document/d/1VQDIAB0OqiSjIHI8AWMvSdceWhnz56jNpZrLs6o7NJY/edit#)

## Release Schedule

**Next Deadline: Enhancements Freeze, Jan 28th**

A failure of version-tagging with the anago build tool last week caused the project not to release 1.16.5 or 1.15.8 on time.  As such, the Release Engineering team will be re-releasing the patch updates on the 21st, which will include 1.17.2.  In related news they are [deprecating use of anago](https://groups.google.com/forum/?utm_medium=email&utm_source=footer#!topic/kubernetes-dev/Mhpx-loSBns) and prioritizing work on a replacement written in go (instead of bash).

## Featured PRs

### [#86408: Support server-side dry-run in cli-runtime REST Helper](https://github.com/kubernetes/kubernetes/pull/86408)

Up until now, the plumbing for server-side dry-run has been directly implemented in the `kubectl apply` command. This has now been moved into the shared `k8s.io/cli-runtime` library used by most kubectl commands. This makes it add server-side dry-run support to other kubectl commands where it is applicable as to third-party kubectl plugins.

### [#76496: Clean deprecated metrics](https://github.com/kubernetes/kubernetes/pull/76496)

A fairly straightforward change, removing a set of deprecated metrics that were mostly renamed around 1.14, but as well all non-code deprecation cleanups this may catch some people unawares. To quote from the patch notes:

```
The following replacement metrics are available from v1.14.0:
* `rest_client_request_latency_seconds` -> `rest_client_request_duration_seconds`
* `scheduler_scheduling_latency_seconds` -> `scheduler_scheduling_duration_seconds `
* `docker_operations` -> `docker_operations_total`
* `docker_operations_latency_microseconds` -> `docker_operations_duration_seconds`
* `docker_operations_errors` -> `docker_operations_errors_total`
* `docker_operations_timeout` -> `docker_operations_timeout_total`
* `network_plugin_operations_latency_microseconds` -> `network_plugin_operations_duration_seconds`
* `kubelet_pod_worker_latency_microseconds` -> `kubelet_pod_worker_duration_seconds`
* `kubelet_pod_start_latency_microseconds` -> `kubelet_pod_start_duration_seconds`
* `kubelet_cgroup_manager_latency_microseconds` -> `kubelet_cgroup_manager_duration_seconds`
* `kubelet_pod_worker_start_latency_microseconds` -> `kubelet_pod_worker_start_duration_seconds`
* `kubelet_pleg_relist_latency_microseconds` -> `kubelet_pleg_relist_duration_seconds`
* `kubelet_pleg_relist_interval_microseconds` -> `kubelet_pleg_relist_interval_seconds`
* `kubelet_eviction_stats_age_microseconds` -> `kubelet_eviction_stats_age_seconds`
* `kubelet_runtime_operations` -> `kubelet_runtime_operations_total`
* `kubelet_runtime_operations_latency_microseconds` -> `kubelet_runtime_operations_duration_seconds`
* `kubelet_runtime_operations_errors` -> `kubelet_runtime_operations_errors_total`
* `kubelet_device_plugin_registration_count` -> `kubelet_device_plugin_registration_total`
* `kubelet_device_plugin_alloc_latency_microseconds` -> `kubelet_device_plugin_alloc_duration_seconds`
* `scheduler_e2e_scheduling_latency_microseconds` -> `scheduler_e2e_scheduling_duration_seconds`
* `scheduler_scheduling_algorithm_latency_microseconds` -> `scheduler_scheduling_algorithm_duration_seconds`
* `scheduler_scheduling_algorithm_predicate_evaluation` -> `scheduler_scheduling_algorithm_predicate_evaluation_seconds`
* `scheduler_scheduling_algorithm_priority_evaluation` -> `scheduler_scheduling_algorithm_priority_evaluation_seconds`
* `scheduler_scheduling_algorithm_preemption_evaluation` -> `scheduler_scheduling_algorithm_preemption_evaluation_seconds`
* `scheduler_binding_latency_microseconds` -> `scheduler_binding_duration_seconds`
* `kubeproxy_sync_proxy_rules_latency_microseconds` -> `kubeproxy_sync_proxy_rules_duration_seconds`
* `apiserver_request_latencies` -> `apiserver_request_duration_seconds`
* `apiserver_dropped_requests` -> `apiserver_dropped_requests_total`
* `etcd_request_latencies_summary` -> `etcd_request_duration_seconds`
* `apiserver_storage_transformation_latencies_microseconds ` -> `apiserver_storage_transformation_duration_seconds`
* `apiserver_storage_data_key_generation_latencies_microseconds` -> `apiserver_storage_data_key_generation_duration_seconds`
* `apiserver_request_count` -> `apiserver_request_total`

The following replacement metrics are available from v1.15.0:
* `apiserver_storage_transformation_failures_total` -> `apiserver_storage_transformation

The following metrics have been removes:
* `apiserver_request_latencies_summary`
```

Make sure to update anything using these metrics before upgrading.

### [#86377: API for immutable Secrets and ConfigMaps](https://github.com/kubernetes/kubernetes/pull/86377)

This adds a top-level `Immutable` field to both `v1/ConfigMap` and `v1/Secret`. Setting this flag will ensure no data changed are allowed. This can both be used to prevent unintended in-place edits, as well as future performance improvements for ConfigMap and Secret volumes as the kubelet can assume they will never change.

## Other Merges

* [#82333: Fix kubectl top sort-by cpu and sort-by memory options](https://github.com/kubernetes/kubernetes/pull/82333)
* [#85281: add `--show-hidden-metrics-for-version` to kube-controller-manager](https://github.com/kubernetes/kubernetes/pull/85281)
* [#85798: add Merge abstraction to TopologyManager policies](https://github.com/kubernetes/kubernetes/pull/85798)
* [#85850: allow kubelet `--node-ip ::` to mean prefer IPv6](https://github.com/kubernetes/kubernetes/pull/85850)
* [#86560: refactoring in server-side apply request handling](https://github.com/kubernetes/kubernetes/pull/86560)
* [#87029: fix authentication errors when not using service account token controller](https://github.com/kubernetes/kubernetes/pull/87029)
* [#87065: initial documentation for hack/ folder](https://github.com/kubernetes/kubernetes/pull/87065)
* [#87091: remove last scheduler dependencies on predicates package](https://github.com/kubernetes/kubernetes/pull/87091)
* [#87203: change apiserver HTTP log format for easy searching](https://github.com/kubernetes/kubernetes/pull/87203)
* [#87261: make the scheduler queue sorter a plugin](https://github.com/kubernetes/kubernetes/pull/87261)
* [#87313: add validation for FlowSchema objects](https://github.com/kubernetes/kubernetes/pull/87313)

## Deprecated

* [#87407: Deprecate scheduler's framework.plugins.RegistryArgs](https://github.com/kubernetes/kubernetes/pull/87407)

## Version Updates

* [#87081: protobuf 1.3.1, grpc 1.26.0](https://github.com/kubernetes/kubernetes/pull/87081)
* [#87088: gonum.org/v1/gonum 0.6.2](https://github.com/kubernetes/kubernetes/pull/87088)
* [#87106: golang 1.13.6](https://github.com/kubernetes/kubernetes/pull/87106)
* [#87107: googleapis/gnostic 0.1.0](https://github.com/kubernetes/kubernetes/pull/87107)
* [#87253: aws-sdk-go 1.28.2](https://github.com/kubernetes/kubernetes/pull/87253)
* [#87326: golang/mock 1.3.1](https://github.com/kubernetes/kubernetes/pull/87326)
